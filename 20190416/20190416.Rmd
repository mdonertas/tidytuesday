---
title: "Economist's 'Mistakes, we’ve drawn a few'"
output: html_notebook
---

# Data description

Sarah Leo from The Economist went through the Economist's archives and found 7 examples of charts that were in need of improvement.

"I grouped our crimes against data visualisation into three categories: charts that are (1) misleading, (2) confusing and (3) failing to make a point. For each, I suggest an improved version that requires a similar amount of space — an important consideration when drawing charts to be published in print."

She was nice enough to include the raw data as .csv files, where I have included both the raw and tidied formats for your graphing fun!

# Setup

```{r message=F, warning=F}
library(tidyverse)
library(ggthemes)
library(ggrepel)
```

# Get the data

```{r message=FALSE, warning=FALSE}
brexit <- read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-04-16/brexit.csv")

corbyn <- read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-04-16/corbyn.csv")

dogs <- read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-04-16/dogs.csv")

eu_balance <- read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-04-16/eu_balance.csv")

pensions <- read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-04-16/pensions.csv")

trade <- read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-04-16/trade.csv")

women_research <- read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-04-16/women_research.csv")
```

# Jeremy Corbyn Facebook Likes

## Original Post

![[link](https://medium.economist.com/mistakes-weve-drawn-a-few-8cdd8a42d368)](https://cdn-images-1.medium.com/max/2600/1*9QE_yL3boSLqopJkSBfL5A.png)

## Recreation

```{r}
corbyn_clean <- corbyn %>%
    rename(name = political_group) %>%
    na.omit()
corbyn_clean
```

```{r}
p_corbyn <- corbyn_clean %>%
    mutate(name = name %>% fct_reorder(avg_facebook_likes) %>% fct_rev()) %>%
    ggplot(aes(y = avg_facebook_likes, x = name, fill = factor(rank(avg_facebook_likes)))) +
    geom_bar(stat = 'identity') +
    coord_flip() +
    theme_economist(dkpanel = T, base_size = 12) +
    xlab('') + ylab('') +
    ggtitle('Left-click','Average number of likes per Facebook post, 2016') +
    scale_fill_brewer(type = 'seq', palette = 8) +
    guides(fill = F) +
    theme(axis.text.y = element_text(hjust = 1),
          panel.grid.major.y = element_blank(),
          panel.grid.major.x = element_line(),
          plot.title = element_text(color = 'darkred', face = 'bold'),
          plot.subtitle = element_text(color = 'gray40', face = 'italic')) +
    scale_y_continuous(labels = scales::comma) +
    labs(caption = 'Source: Facebook')
```

```{r, fig.align='centre'}
p_corbyn
```

```{r, echo = F}
ggsave('./corbyn.pdf', p_corbyn, units = 'cm', height = 8, width = 16)
ggsave('./corbyn.png', p_corbyn, units = 'cm', height = 8, width = 16)
```

# Dog Size

## Original Post

![[link](https://medium.economist.com/mistakes-weve-drawn-a-few-8cdd8a42d368)](https://cdn-images-1.medium.com/max/2600/1*H21mduPmvzot3oaMThNfFQ.png)

## Recreation

```{r}
head(dogs)
```

```{r}
p_dogs <- dogs %>%
    mutate(year = lubridate::ymd(dogs$year, truncated = 2L)) %>%
    ggplot(aes(x = year)) + 
    geom_line(aes(y = avg_neck, color = 'Neck Size'), size = 3) +
    geom_line(aes(y = (avg_weight+1)*2, color = 'Weight'), size = 3) +
    scale_y_continuous(sec.axis = sec_axis(~./2 - 1, name = "Weight**, kg",), 
                       limits = c(38,45)) +
    theme_economist(base_size = 12) +
    scale_x_date() + 
    scale_colour_manual(values = c("darkred", "steelblue3")) +
    ggtitle('Fit as a butcher\'s dog','Characteristics of registered with the UK\'s\nKennel Club, average when fully grown') +
    guides(color = F) +
    xlab('') +
    ylab('Neck Size*, cm') +
    labs(caption = '*Where at least 100 are registered per year\n**Where at least 50 are registered per year\nSources: Kennel Club; The Economist') +
    theme(axis.title.y.left = element_text(angle = 0, colour = 'darkred', 
                                           face = 'italic', hjust = 0, 
                                           margin = margin(0,-80,0,0)),
          axis.title.y.right = element_text(angle = 0, colour = 'steelblue3', 
                                            face = 'italic', hjust = 1, 
                                            margin = margin(0,0,0,-70), 
                                            vjust = 1),
          axis.text.y.right = element_text(margin = margin(0,0,0,10)),
          plot.subtitle = element_text(margin = margin(0,0,20,0)))
```

```{r, fig.align='centre'}
p_dogs
```

```{r, echo = F}
ggsave('./dogs.pdf', p_dogs, units = 'cm', height = 10, width = 10)
ggsave('./dogs.png', p_dogs, units = 'cm', height = 10, width = 10)
```

## My attempt

```{r}
p_dogs2 <- dogs %>%
    # mutate(year = lubridate::ymd(dogs$year, truncated = 2L)) %>%
    ggplot(aes(x = avg_weight, y = avg_neck, color = year)) +
    geom_point(size = 2) +
    geom_path(size = 1,arrow = arrow(length = unit(8,"pt"))) +
    geom_label(data = filter(dogs, year %in% c(2006, 2015)),
                     aes(label = year, fill = year), 
                     color = 'white', nudge_y = -0.2) +
    theme_economist() +
    theme(legend.position = 'right') +
    ggtitle('Fit as a butcher\'s dog','Characteristics of registered with the UK\'s Kennel Club,\naverage when fully grown') +
    xlab('Weight**, kg') + ylab('Neck Size*, cm') +
    scale_y_continuous(breaks = 42:44, limits = c(42,44.4)) +
    scale_x_continuous(breaks = 18:20, limits = c(18,20.6)) +
    labs(caption = '*Where at least 100 are registered per year\n**Where at least 50 are registered per year\nSources: Kennel Club; The Economist') +
    scale_color_gradient(low = 'lightsteelblue3', high = 'steelblue4', breaks = c(2006,2015), guide = F) +
    scale_fill_gradient(low = 'lightsteelblue3', high = 'steelblue4', breaks = c(2006,2015), guide =F)
```

```{r, fig.align='centre'}
p_dogs2
```

```{r, echo = F}
ggsave('./dogs2.pdf', p_dogs2, units = 'cm', height = 10, width = 12)
ggsave('./dogs2.png', p_dogs2, units = 'cm', height = 10, width = 12)
```
